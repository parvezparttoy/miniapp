<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Mining Bot (Debug)</title>
<style>
  :root{
    --bg1:#0b1120; --bg2:#0a1228; --bg3:#07111c;
    --card:#0f172a; --line:#15223d;
    --text:#e6f0ff; --muted:#9fb5d8;
    --accent:#00e5ff; --brand:#ef0027;
    --btn:#0b1530; --btnline:#1c2e52;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
    color:var(--text);
    background:
      radial-gradient(900px 600px at 20% -10%, rgba(0,229,255,.08), transparent 60%),
      radial-gradient(800px 500px at 80% 0%, rgba(239,0,39,.06), transparent 55%),
      linear-gradient(180deg,var(--bg1),var(--bg2) 40%,var(--bg3));
  }
  .wrap{max-width:560px;margin:0 auto;padding:12px 12px 110px}
  .devnote{position:sticky;top:0;z-index:8;background:rgba(10,17,32,.9);border-bottom:1px solid #0e1a33;padding:8px 12px;font-size:12px;color:var(--muted);backdrop-filter:blur(6px)}
  .devnote a{color:#7dd3fc;text-decoration:none}

  .welcome{background:rgba(15,23,42,.7);border:1px solid var(--line);padding:10px 12px;border-radius:12px;margin:8px 0}
  .title{font-size:18px;font-weight:800;margin:0;color:#7dd3fc}
  .sub{font-size:12px;color:var(--muted);margin-top:4px}

  .card{background:rgba(15,23,42,.72);border:1px solid var(--line);border-radius:16px;padding:12px;margin-top:12px;box-shadow:0 10px 30px rgba(0,0,0,.28)}
  h2{margin:6px 0 8px;font-size:16px}
  .center{text-align:center}
  .row{display:flex;gap:10px;align-items:center}
  .col{display:flex;flex-direction:column;gap:10px}
  .pill{display:inline-block;background:#0e1626;border:1px solid #243754;color:#9db2d3;padding:6px 10px;border-radius:999px;font-size:12px}
  .trx-giant{width:180px;height:180px;border-radius:50%;display:grid;place-items:center;background:#22060a;border:3px solid #3c0b12;box-shadow:0 25px 80px rgba(239,0,39,.35);margin:0 auto 10px}
  .trx-giant svg{width:122px;height:122px;fill:var(--brand)}
  .btn{background:var(--btn);border:1px solid var(--btnline);color:#dbeafe;padding:10px 12px;border-radius:14px;font-weight:800;text-align:center;cursor:pointer}
  .btn.accent{background:var(--brand);border-color:var(--brand);color:#fff}
  .btn:disabled{opacity:.6;cursor:not-allowed}
  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .statrow{display:flex;justify-content:center;gap:8px;margin:8px 0}
  .balance{font-size:22px;font-weight:900}

  .page{display:none}
  #home:target,#mining:target,#task:target,#wallet:target,#refer:target,#deposit:target,#withdraw:target{display:block}
  body:not([data-hash]) #home{display:block}

  .tabbar{position:fixed;left:0;right:0;bottom:0;display:flex;gap:6px;justify-content:center;padding:8px 10px 10px;background:rgba(10,15,25,.9);border-top:1px solid #0f1a2a;backdrop-filter:blur(6px);z-index:9}
  .tab{flex:1;max-width:120px;background:transparent;border:0;color:#a9b9d6;font-weight:700;padding:6px 0 4px;text-align:center;text-decoration:none}
  .tab .ico{display:block;margin:0 auto 6px;width:22px;height:22px;opacity:.7}
  .tab.active{color:var(--accent)}
  .tab.active .ico{opacity:1;filter:drop-shadow(0 0 4px rgba(0,229,255,.55))}

  .toast{position:fixed;left:50%;bottom:86px;transform:translateX(-50%);background:#0b1f33;border:1px solid #134063;color:#dff6ff;padding:8px 12px;border-radius:10px;font-weight:700;opacity:0;pointer-events:none;transition:opacity .25s;z-index:99}
  .toast.show{opacity:1}

  /* DEBUG */
  .dbg{position:fixed;right:10px;top:52px;background:#12233b;border:1px solid #1f3a67;color:#bfe1ff;padding:6px 8px;border-radius:8px;font-size:12px;z-index:99}
  .dbg.ok{background:#0d2a16;border-color:#185a2a;color:#bfffcf}
  .err{position:fixed;left:10px;right:10px;top:80px;background:#3b1010;border:1px solid #7a1f1f;color:#ffd6d6;padding:10px;border-radius:10px;z-index:100;display:none;white-space:pre-wrap}
</style>
</head>
<body>

<div class="devnote">Developer: <a href="https://t.me/ToxicNexo" target="_blank">t.me/ToxicNexo</a></div>
<div id="dbg" class="dbg">JS: loading…</div>
<div id="err" class="err"></div>

<div class="wrap">
  <div class="welcome">
    <div class="title">Welcome</div>
    <div class="sub">Use the tabs below to navigate. Buy a plan to enable mining.</div>
  </div>

  <!-- HOME -->
  <section id="home" class="page">
    <div class="card center">
      <div class="trx-giant" aria-hidden="true">
        <svg viewBox="0 0 24 24"><path d="M23.938 7.604 16.63.297H7.353L.046 7.604l11.236 16.21 12.656-16.21Zm-7.91-5.74 6.94 6.94-4.094 1.276-4.67-7.927 1.82-.29h.004ZM12.6 3.17l4.922 8.356-3.59 1.118-4.9-6.76 3.568-2.714ZM6.94 4.22 10.7 9.28l-6.39 1.97 2.63-7.03Zm-4.49 5.57 8.83-2.73 4.71 6.5-3.04 8.25L2.45 9.79Zm12.41 12.41 2.62-7.11 3.35-1.05-5.97 8.16Z"/></svg>
      </div>
      <h2>Home</h2>
      <div class="statrow">
        <span class="pill">Mining: <b id="status">Stop</b></span>
        <span class="pill">Time <b id="time">00:00</b></span>
      </div>
      <div class="sub">Current Plan: <b id="planName">None</b> • Rate: <b id="rateText">0.000000 TRX/sec</b></div>
    </div>
  </section>

  <!-- MINING -->
  <section id="mining" class="page">
    <div class="card center">
      <h2>Mining Control</h2>
      <button id="toggleMining" class="btn accent" style="width:100%"><span class="label">Start / Stop Mining</span><span class="hint">Requires any purchased plan</span></button>
    </div>
    <div class="card">
      <h2>Buy Mining Plan</h2>
      <div class="grid2">
        <button class="btn plan" data-plan="TM1" data-cost="10" data-rate="0.000100"><span class="label">Buy Mining TM1</span></button>
        <button class="btn plan" data-plan="TM2" data-cost="20" data-rate="0.000300"><span class="label">Buy Mining TM2</span></button>
        <button class="btn plan" data-plan="TM3" data-cost="30" data-rate="0.000700"><span class="label">Buy Mining TM3</span></button>
        <button class="btn" disabled><span class="label">More Soon</span></button>
      </div>
      <div class="sub" style="margin-top:8px">Purchasing deducts TRX from your balance (local demo).</div>
    </div>
  </section>

  <!-- TASK -->
  <section id="task" class="page">
    <div class="card">
      <h2>Task</h2>
      <div class="col">
        <div class="row" style="justify-content:space-between;align-items:center">
          <div>
            <div><b>Join our channel</b></div>
            <a href="https://t.me/+JQdsBNK6nE1kNTg1" target="_blank">Go to channel</a>
            <div class="sub">Join then tap Complete to get +0.1 TRX</div>
          </div>
          <button class="btn accent complete" data-id="t1"><span class="label">Complete</span></button>
        </div>
        <hr style="border:0;border-top:1px solid var(--line)">
        <div class="row" style="justify-content:space-between;align-items:center">
          <div>
            <div><b>Join our channel 2</b></div>
            <a href="https://t.me/+JQdsBNK6nE1kNTg1" target="_blank">Go to channel</a>
            <div class="sub">+0.1 TRX</div>
          </div>
          <button class="btn accent complete" data-id="t2"><span class="label">Complete</span></button>
        </div>
        <hr style="border:0;border-top:1px solid var(--line)">
        <div class="row" style="justify-content:space-between;align-items:center">
          <div>
            <div><b>Join our channel 3</b></div>
            <a href="https://t.me/+JQdsBNK6nE1kNTg1" target="_blank">Go to channel</a>
            <div class="sub">+0.1 TRX</div>
          </div>
          <button class="btn accent complete" data-id="t3"><span class="label">Complete</span></button>
        </div>
      </div>
    </div>
  </section>

  <!-- WALLET -->
  <section id="wallet" class="page">
    <div class="card center">
      <div class="trx-giant" aria-hidden="true">
        <svg viewBox="0 0 24 24"><path d="M23.938 7.604 16.63.297H7.353L.046 7.604l11.236 16.21 12.656-16.21Z"/></svg>
      </div>
      <h2>Wallet</h2>
      <div class="row" style="justify-content:space-between;align-items:flex-end;margin-top:6px">
        <div>
          <div class="sub">Main Balance</div>
          <div id="balance" class="balance">0.000000 TRX</div>
        </div>
        <div class="row" style="gap:8px">
          <a href="#deposit" class="btn"><span class="label">Deposit</span></a>
          <a href="#withdraw" class="btn accent"><span class="label">Withdraw</span></a>
        </div>
      </div>
      <div class="sub" style="margin-top:8px">Deposit verifies your Tx on-chain (client-side demo).</div>
    </div>
  </section>

  <!-- DEPOSIT -->
  <section id="deposit" class="page">
    <div class="card">
      <a href="#wallet" class="btn" style="margin-bottom:10px">← Back</a>
      <h2>Deposit TRX</h2>

      <div style="margin:10px 0;padding:10px;border:1px dashed #2b3b5d;border-radius:10px">
        <div class="sub">Deposit Address</div>
        <div id="depAddr" style="word-break:break-all;font-weight:800">TJBwEqi3izv5r3myXf7BV6hKdJYLBLoEw2</div>
        <button id="copyAddr" class="btn" style="margin-top:8px">Copy address</button>
      </div>

      <label class="sub">Your Transaction ID (TxID)</label>
      <input id="txid" placeholder="Paste TxID…" style="width:100%;padding:10px;border-radius:10px;border:1px solid #223553;background:#0f172a;color:#dbeafe">
      <button id="verifyBtn" class="btn accent" style="width:100%;margin-top:10px">Verify & Credit</button>
      <div id="depMsg" class="sub" style="margin-top:10px"></div>
    </div>
  </section>

  <!-- WITHDRAW -->
  <section id="withdraw" class="page">
    <div class="card">
      <a href="#wallet" class="btn" style="margin-bottom:10px">← Back</a>
      <h2>Withdraw TRX</h2>
      <label class="sub">Enter TRX address</label>
      <input id="wdAddr" placeholder="TRX address (T...)" style="width:100%;padding:10px;border-radius:10px;border:1px solid #223553;background:#0f172a;color:#dbeafe">
      <label class="sub" style="margin-top:10px">Enter amount</label>
      <input id="wdAmt" type="number" min="1" step="0.000001" placeholder="Amount in TRX" style="width:100%;padding:10px;border-radius:10px;border:1px solid #223553;background:#0f172a;color:#dbeafe">
      <button id="wdConfirm" class="btn accent" style="width:100%;margin-top:10px">Confirm</button>
      <div id="wdMsg" class="sub" style="margin-top:10px"></div>
    </div>
  </section>

  <!-- REFER -->
  <section id="refer" class="page">
    <div class="card">
      <h2>Refer</h2>
      <div class="sub">Per refer bonus: <b>0.1 TRX</b> — Refer and earn more.</div>

      <div style="margin-top:12px;padding:10px;border:1px solid var(--line);border-radius:12px;background:#0f172a">
        <div class="sub">Your referral code</div>
        <div id="refCode" style="font-weight:900;font-size:18px;letter-spacing:.5px;margin:4px 0">—</div>
        <div class="sub">Referral link</div>
        <div id="refLink" style="word-break:break-all;margin:4px 0">—</div>
        <button id="copyRef" class="btn accent">Copy referral link</button>
        <div id="refMsg" class="sub" style="margin-top:6px"></div>
      </div>

      <div class="row" style="justify-content:space-between;margin-top:12px">
        <div class="sub">Total refer: <b id="refCount">0</b></div>
        <div class="sub">Total refer bonus: <b id="refBonus">0.0 TRX</b></div>
      </div>
    </div>
  </section>
</div>

<!-- Tabs -->
<div class="tabbar" id="tabs">
  <a class="tab" data-tab="home" href="#home"><svg class="ico" viewBox="0 0 24 24"><path fill="currentColor" d="M3 10.5 12 3l9 7.5V21a1 1 0 0 1-1 1h-5v-7H9v7H4a1 1 0 0 1-1-1z"/></svg>Home</a>
  <a class="tab" data-tab="mining" href="#mining"><svg class="ico" viewBox="0 0 24 24"><path fill="currentColor" d="M10 2 8.6 3.4 13.2 8l-1.2 1.2-1.7-1.7L5 12v3l-2 2 2 2 2-2h3l6.5-6.3-1.7-1.7L15 7.2 20.6 12 22 10.6 10 2z"/></svg>Mining</a>
  <a class="tab" data-tab="task" href="#task"><svg class="ico" viewBox="0 0 24 24"><path fill="currentColor" d="M7 3h10a2 2 0 0 1 2 2v14l-7-3-7 3V5a2 2 0 0 1 2-2z"/></svg>Task</a>
  <a class="tab" data-tab="wallet" href="#wallet"><svg class="ico" viewBox="0 0 24 24"><path fill="currentColor" d="M3 7a2 2 0 0 1 2-2h12a3 3 0 0 1 3 3v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7zm14 3h3v4h-3a2 2 0 0 1-2-2 2 2 0 0 1 2-2z"/></svg>Wallet</a>
  <a class="tab" data-tab="refer" href="#refer"><svg class="ico" viewBox="0 0 24 24"><path fill="currentColor" d="M10.59 13.41 9.17 12l6-6 1.41 1.41-6 6zM7 6h4V4H7a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3v-4h-2v4H7V6z"/></svg>Refer</a>
</div>

<div id="toast" class="toast">Copied!</div>

<script defer>
(function(){
  var dbg = document.getElementById('dbg');
  function ok(m){ dbg.textContent = m||'JS: ok'; dbg.classList.add('ok'); }
  function log(){ try{ console.log.apply(console, arguments); }catch(e){} }

  // show runtime errors on screen
  window.onerror = function(msg, src, line, col, err){
    var box = document.getElementById('err');
    box.style.display='block';
    box.textContent = 'JS Error: ' + msg + '\n' + (src||'') + ':' + (line||0) + ':' + (col||0);
    dbg.textContent = 'JS: error';
    dbg.classList.remove('ok');
  };

  // wait DOM ready
  document.addEventListener('DOMContentLoaded', function(){
    ok('JS: loaded');

    function $(q){return document.querySelector(q);}
    function $all(q){return document.querySelectorAll(q);}
    function toast(msg){
      var t=$("#toast"); if(!t) return;
      t.textContent=msg||"Done"; t.classList.add("show");
      clearTimeout(toast._t); toast._t=setTimeout(function(){t.classList.remove("show");},1200);
    }
    function setDefaultHash(){ if(!location.hash){ document.body.removeAttribute('data-hash'); } else { document.body.setAttribute('data-hash','1'); } }
    setDefaultHash(); window.addEventListener('hashchange', setDefaultHash);

    function syncActive(){
      var h=(location.hash||"#home").replace("#","");
      var tabs=$all(".tab"); for(var i=0;i<tabs.length;i++){ tabs[i].classList.toggle("active", tabs[i].getAttribute("data-tab")===h); }
    }
    syncActive(); window.addEventListener('hashchange', syncActive);

    var S={}; try{ S=JSON.parse(localStorage.getItem('mining_state_pages')||'{}'); }catch(e){}
    var state={balance:0,mining:false,sessionSec:0,purchased:{TM1:false,TM2:false,TM3:false},plan:"None",rate:0,lastTick:Date.now(),tasks:{t1:false,t2:false,t3:false}};
    for(var k in S){ state[k]=S[k]; }
    function save(){ localStorage.setItem('mining_state_pages', JSON.stringify(state)); }
    function fmtTRX(x){ return (Math.floor(x*1e6)/1e6).toFixed(6); }
    function mmss(s){ var m=(s/60|0), ss=s%60; return (m<10?'0':'')+m+':' + (ss<10?'0':'')+ss; }

    var statusEl=$("#status"), timeEl=$("#time"), planNameEl=$("#planName"), rateTextEl=$("#rateText"), balanceEl=$("#balance");
    function render(){
      if(statusEl) statusEl.textContent = state.mining ? "Start" : "Stop";
      if(timeEl) timeEl.textContent = mmss(state.sessionSec);
      if(planNameEl) planNameEl.textContent = state.plan;
      if(rateTextEl) rateTextEl.textContent = fmtTRX(state.rate) + " TRX/sec";
      if(balanceEl) balanceEl.textContent = fmtTRX(state.balance) + " TRX";
      var completes=$all(".complete");
      for(var i=0;i<completes.length;i++){ var id=completes[i].getAttribute("data-id"); if(state.tasks[id]){ completes[i].textContent="Completed"; completes[i].disabled=true; } }
      var plans=$all(".plan");
      for(var j=0;j<plans.length;j++){ var p=plans[j].getAttribute("data-plan"); if(state.purchased[p]){ plans[j].classList.add("accent"); } }
    }

    function hasAnyPlan(){ return state.purchased.TM1||state.purchased.TM2||state.purchased.TM3; }

    var toggleBtn=$("#toggleMining");
    if(toggleBtn){
      toggleBtn.addEventListener("click", function(){
        log('click: toggleMining');
        if(!hasAnyPlan()){ alert("Please buy a mining plan first."); return; }
        state.mining=!state.mining; if(state.mining) state.lastTick=Date.now();
        render(); save(); toast("Mining "+(state.mining?'started':'stopped'));
      });
    }

    var planBtns=$all(".plan");
    for(var p=0;p<planBtns.length;p++){
      planBtns[p].addEventListener("click", function(){
        var plan=this.getAttribute("data-plan"), cost=Number(this.getAttribute("data-cost")), rate=Number(this.getAttribute("data-rate"));
        log('click: plan', plan);
        if(state.purchased[plan]){ state.plan=plan; state.rate=rate; render(); save(); toast(plan+" active"); return; }
        if(state.balance<cost){ alert("Not enough balance. Need "+cost+" TRX."); return; }
        state.balance-=cost; state.purchased[plan]=true; state.plan=plan; state.rate=rate; render(); save(); toast(plan+" purchased");
      });
    }

    var comp=$all(".complete");
    for(var c=0;c<comp.length;c++){
      comp[c].addEventListener("click", function(){
        var id=this.getAttribute("data-id"); log('click: task', id);
        if(state.tasks[id]) return; state.tasks[id]=true; state.balance+=0.1; render(); save(); toast("+0.1 TRX added");
      });
    }

    // Copy helpers
    function copyText(text, okCb, errCb){
      try{ if(navigator.clipboard && window.isSecureContext){ navigator.clipboard.writeText(text).then(okCb, errCb); return; } }catch(e){}
      try{ var ta=document.createElement('textarea'); ta.value=text; ta.style.position='fixed'; ta.style.left='-9999px'; document.body.appendChild(ta); ta.focus(); ta.select(); var ok=document.execCommand('copy'); document.body.removeChild(ta); if(ok && okCb) okCb(); else if(errCb) errCb(); }catch(e2){ if(errCb) errCb(); }
    }

    var DEPOSIT_ADDR='TJBwEqi3izv5r3myXf7BV6hKdJYLBLoEw2';
    var copyAddr=$("#copyAddr");
    if(copyAddr){ copyAddr.addEventListener("click", function(){ log('click: copyAddr'); copyText(DEPOSIT_ADDR, function(){ toast("Address copied"); }, function(){ alert("Copy failed"); }); }); }

    // simple fake withdraw(deposit verify বাদ দেওয়া হলো ডিবাগের জন্য)
    var wdBtn=$("#wdConfirm");
    if(wdBtn){ wdBtn.addEventListener("click", function(){ log('click: withdraw'); var addr=($("#wdAddr").value||"").trim(), amt=Number(($("#wdAmt").value||"0")), msg=$("#wdMsg"); if(!addr||addr.charAt(0)!=='T'){ msg.textContent="Enter a valid TRX address."; return; } if(!(amt>0)){ msg.textContent="Enter a valid amount."; return; } if(amt>state.balance){ msg.textContent="Insufficient balance."; return; } state.balance-=amt; render(); save(); msg.textContent="Withdraw request submitted: "+amt+" TRX to "+addr+"."; toast("Withdraw requested"); }); }

    // referral mock
    var REF_BASE='http://t.me/VairalVideoInTelegramBOT/AllLink';
    function getRefCode(){ var c=localStorage.getItem('ref_code'); if(!c){ c=Math.random().toString(36).slice(2,8).toUpperCase(); localStorage.setItem('ref_code',c);} return c; }
    (function setupRef(){
      var code=getRefCode(), link=REF_BASE+'?start='+code;
      var rc=$("#refCode"); if(rc) rc.textContent=code;
      var rl=$("#refLink"); if(rl) rl.textContent=link;
      var cr=$("#copyRef"); if(cr){ cr.onclick=function(){ log('click: copyRef'); copyText(link,function(){ toast("Referral link copied"); var m=$("#refMsg"); if(m) m.textContent="Copied!"; },function(){ alert("Copy failed"); }); }; }
    })();

    // mining tick
    function tick(){ var now=Date.now(), dt=Math.max(0, now-state.lastTick); if(state.mining){ var dsec=(dt/1000)|0; if(dsec>0){ state.lastTick+=dsec*1000; state.sessionSec+=dsec; state.balance+=state.rate*dsec; render(); save(); } } else { state.lastTick=now; } requestAnimationFrame(tick); }
    render(); requestAnimationFrame(tick);
  });
})();
</script>
</body>
                                   </html>
