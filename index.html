<!doctype html>
<html lang="bn">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Unlimited Vairal Video ‚Äì Ads Unlock üîì</title>

<!-- Telegram SDK -->
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<!-- Axidum / Adexium SDK -->
<script src="https://cdn.tgads.space/assets/js/adexium-widget.min.js"></script>

<style>
  :root{
    --bg1:#0b1220; --bg2:#0a1220;
    --glow1:#0ea5e9; --glow2:#22c55e;
    --card:#0d1426; --card-bd:#1f2a44;
    --text:#e5e7eb; --muted:#9aa4b2;
    --primary:#22d3ee; --primary-d:#0ea5e9;
    --ok:#22c55e; --soft:#334155; --like:#f43f5e;
  }
  *{box-sizing:border-box}
  body{
    margin:0;color:var(--text);
    font:14px/1.5 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
    background:
      radial-gradient(900px 600px at 15% -10%, rgba(14,165,233,.25), transparent 60%),
      radial-gradient(900px 600px at 100% -10%, rgba(34,197,94,.18), transparent 50%),
      linear-gradient(180deg, #0a1220, #0b1220 40%, #0a1423);
    min-height:100vh; display:flex; flex-direction:column; padding-bottom:92px;
  }
  .wrap{max-width:960px;margin:0 auto;padding:18px 16px;flex:1}
  h2{margin:6px 0 10px;font-weight:900;font-size:22px;letter-spacing:.2px}

  /* search (Home only) */
  .search{position:sticky; top:0; z-index:10; margin:10px 0 16px;
    background:rgba(13,20,38,.7); backdrop-filter:blur(6px);
    border:1px solid rgba(255,255,255,.08); border-radius:14px; padding:10px 12px; display:flex; gap:8px; align-items:center}
  .search svg{width:18px;height:18px;stroke:#93c5fd;fill:none}
  .search input{flex:1;background:transparent;border:none;outline:none;color:#e5e7eb;font-weight:700}
  .search input::placeholder{color:#9aa4b2}
  .hide{display:none}

  /* card */
  .card{position:relative;background:linear-gradient(180deg,#0e1629,#0a1220);
    border:1px solid var(--card-bd); border-radius:18px;padding:14px;margin-bottom:16px;
    box-shadow:0 10px 25px rgba(2,6,23,.35), inset 0 1px 0 rgba(255,255,255,.03)}
  .thumb{width:100%;aspect-ratio:16/9;object-fit:cover;border-radius:14px;background:#1f2937}
  .title{font-weight:900;margin:12px 0 6px;font-size:16px}
  .names{font-size:12px;color:#a7b0bf;margin-top:-2px;margin-bottom:8px}
  .desc{color:var(--muted);margin:0 0 12px}
  .progress{height:8px;background:#0c1322;border:1px solid #1f2a44;border-radius:999px;overflow:hidden;margin-bottom:12px}
  .bar{height:100%;width:0;background:linear-gradient(90deg,var(--glow2),#a3e635);transition:width .3s}
  .row{display:flex;gap:10px}
  .btn{flex:1;padding:12px;border:none;border-radius:12px;font-weight:900;letter-spacing:.2px;cursor:pointer}
  .watch{background:linear-gradient(180deg,var(--primary),var(--primary-d));color:#012031;box-shadow:0 6px 18px rgba(14,165,233,.35)}
  .watch.disabled{background:#283445;color:#94a3b8;cursor:not-allowed;box-shadow:none}
  .join{background:#253244;color:#cbd5e1}
  .join.ready{background:var(--ok);color:#062012;box-shadow:0 6px 18px rgba(34,197,94,.35)}

  /* BIG like button */
  .like{
    position:absolute;top:10px;right:10px;background:rgba(255,255,255,.08);
    border:1px solid rgba(255,255,255,.18);backdrop-filter: blur(3px);
    width:50px;height:50px;border-radius:16px;display:grid;place-items:center;cursor:pointer;
    box-shadow: 0 8px 22px rgba(0,0,0,.38)
  }
  .like svg{width:28px;height:28px;fill:none;stroke:#e5e7eb;stroke-width:2}
  .like.active{background:rgba(244,63,94,.22);border-color:rgba(244,63,94,.45)}
  .like.active svg{fill:var(--like);stroke:var(--like)}

  .view{display:none}
  .view.active{display:block}

  /* modal */
  .modal{position:fixed;inset:0;background:rgba(2,6,23,.7);backdrop-filter:blur(2px);
    display:none;align-items:center;justify-content:center;padding:16px;z-index:9999}
  .sheet{width:100%;max-width:420px;background:#0b1220;border:1px solid var(--card-bd);
    border-radius:16px;overflow:hidden;box-shadow:0 20px 50px rgba(0,0,0,.6)}
  .sheethd{padding:12px 14px;border-bottom:1px solid var(--card-bd);display:flex;justify-content:space-between;align-items:center}
  .sheethd b{color:#93c5fd}
  .sheetbd{padding:14px}
  .close{border:none;background:transparent;font-size:18px;color:#cbd5e1;cursor:pointer}
  .hint{font-size:12px;color:var(--muted);margin-top:6px}

  /* bottom nav: pill bar */
  .dock{position:fixed;left:12px;right:12px;bottom:12px;z-index:999;
    background:rgba(12,19,34,.9);backdrop-filter:blur(10px);
    border:1px solid rgba(255,255,255,.08); border-radius:22px; padding:12px 8px}
  .nav{display:grid;grid-template-columns:repeat(4,1fr);gap:6px;align-items:center}
  .tab{display:flex;flex-direction:column;align-items:center;gap:6px;padding:8px 0;border-radius:14px;color:#cbd5e1;text-decoration:none;cursor:pointer}
  .tab svg{width:22px;height:22px;stroke:#cbd5e1;fill:none;stroke-width:2}
  .tab.active{color:#7dd3fc}
  .tab.active svg{stroke:#7dd3fc}
  .tablabel{font-weight:900}

  /* foot notes (Home) */
  .footnote{font-size:12px;color:#9aa4b2;margin:14px 2px 6px}
  .footnote a{color:#93c5fd;text-decoration:none;font-weight:800}
  .footnote a:hover{text-decoration:underline}

  /* Links list */
  .links-h{display:flex;align-items:center;gap:10px;margin:6px 0 12px}
  .links-h svg{width:24px;height:24px;stroke:#93c5fd;fill:none}
  .linkcard{display:flex;align-items:center;justify-content:space-between;gap:12px;background:linear-gradient(180deg,#0f182c,#0b1324);
    border:1px solid var(--card-bd);border-radius:18px;padding:14px 16px;margin:8px 0}
  .linkleft{display:flex;align-items:center;gap:12px}
  .tgicon{width:36px;height:36px;border-radius:999px;display:grid;place-items:center;background:#0e2a44}
  .tgicon svg{width:20px;height:20px;stroke:#93c5fd}
  .openbtn{padding:10px 16px;border:none;border-radius:12px;font-weight:900;color:#001b30;
    background:linear-gradient(180deg,#7dd3fc,#60a5fa);box-shadow:0 6px 18px rgba(96,165,250,.35);cursor:pointer}
</style>
</head>
<body>
  <div class="wrap">
    <h2>Unlimited Vairal Video ‚Äì Ads Unlock üîì</h2>

    <!-- SEARCH (Home only) -->
    <div id="searchWrap" class="search">
      <svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="7"/><path d="M21 21l-4.3-4.3"/></svg>
      <input id="searchInput" type="text" placeholder="Search posts (e.g. era, era video, ridhii)"/>
    </div>

    <!-- HOME -->
    <div id="view-home" class="view active"></div>
    <div id="home-notes" class="footnote">
      Invite friend: <a href="https://parvezparttoy.github.io/miniapp/" target="_blank" rel="noopener">https://parvezparttoy.github.io/miniapp/</a><br/>
      App Community: <a href="http://t.me/VairalVideoInTelegramBOT" data-tglink>t.me/VairalVideoInTelegramBOT</a>
    </div>

    <!-- LIKED -->
    <div id="view-liked" class="view">
      <div id="liked-container"></div>
      <p style="color:var(--muted);margin-top:8px">‡¶Ü‡¶™‡¶®‡¶ø ‡¶Ø‡ßá ‡¶™‡ßã‡¶∏‡ßç‡¶ü‡¶ó‡ßÅ‡¶≤‡ßã ‚ù§Ô∏è ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶®, ‡¶∏‡ßá‡¶ó‡ßÅ‡¶≤‡ßã ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶•‡¶æ‡¶ï‡¶¨‡ßá‡•§</p>
    </div>

    <!-- TUTORIAL -->
    <div id="view-tutorial" class="view">
      <div class="card">
        <div class="title">How to Unlock & Earn</div>
        <ol class="desc" style="margin-left:18px">
          <li>‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶™‡ßã‡¶∏‡ßç‡¶ü‡ßá <b>Watch Ads</b> ‡¶ö‡¶æ‡¶™‡ßÅ‡¶®‡•§</li>
          <li>Ad ‡¶ö‡¶≤‡¶æ‡¶ï‡¶æ‡¶≤‡ßÄ‡¶® ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶´‡ßã‡¶ï‡¶æ‡¶∏‡ßá ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶®; <b>‡ß®‡ß¶ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°</b> ‡¶∂‡ßá‡¶∑‡ßá ‡¶Ö‡¶ü‡ßã ‡ßß ‡¶ï‡ßü‡ßá‡¶® ‡¶Ø‡ßã‡¶ó ‡¶π‡¶¨‡ßá‡•§</li>
          <li>‡ßß‡ß¶/‡ßß‡ß¶ ‡¶π‡¶≤‡ßá <b>Join Channel</b> ‡¶∏‡¶¨‡ßÅ‡¶ú ‡¶π‡¶¨‡ßá ‚Äî ‡¶§‡¶æ‡¶§‡ßá‡¶á ‡¶ï‡¶®‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ü‡¶®‡¶≤‡¶ï‡•§</li>
          <li>‡¶∞‡¶ø‡ßü‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶π‡¶≤‡ßá ‡¶Ü‡¶∞‡ßç‡¶®‡¶ø‡¶Ç Axidum ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü‡•§</li>
        </ol>
      </div>
    </div>

    <!-- LINKS -->
    <div id="view-links" class="view">
      <div class="links-h">
        <svg viewBox="0 0 24 24"><path d="M10 13a5 5 0 0 0 7 0l3-3a5 5 0 0 0-7-7l-1.5 1.5"/><path d="M14 11a5 5 0 0 0-7 0l-3 3a5 5 0 0 0 7 7L12.5 20"/></svg>
        <h3 style="margin:0;font-size:22px">Useful Links</h3>
      </div>

      <!-- Community -->
      <div class="linkcard">
        <div class="linkleft">
          <span class="tgicon">
            <svg viewBox="0 0 24 24"><path d="M22 2L11 13" /><path d="M22 2L15 22l-4-9-9-4 20-7z"/></svg>
          </span>
          <div>
            <div style="font-weight:900;font-size:18px">Community</div>
            <div class="desc">t.me/VairalVideoInTelegram</div>
          </div>
        </div>
        <button class="openbtn" data-go="https://t.me/VairalVideoInTelegram">Open</button>
      </div>

      <!-- Demo/Bot -->
      <div class="linkcard">
        <div class="linkleft">
          <span class="tgicon">
            <svg viewBox="0 0 24 24"><path d="M22 2L11 13" /><path d="M22 2L15 22l-4-9-9-4 20-7z"/></svg>
          </span>
          <div>
            <div style="font-weight:900;font-size:18px">Demo Bot</div>
            <div class="desc">t.me/VairalVideoInTelegramBOT</div>
          </div>
        </div>
        <button class="openbtn" data-go="http://t.me/VairalVideoInTelegramBOT">Open</button>
      </div>

      <div class="footnote">Community: <a href="https://t.me/VairalVideoInTelegram" data-tglink>t.me/VairalVideoInTelegram</a></div>
    </div>
  </div>

  <!-- Interstitial Modal -->
  <div class="modal" id="adModal">
    <div class="sheet">
      <div class="sheethd">
        <b>Sponsored</b>
        <button class="close" id="closeModal">‚úï</button>
      </div>
      <div class="sheetbd">
        <div id="ax-container" style="display:none"></div>
        <div class="hint">Ad ‡¶ö‡¶≤‡¶æ‡¶ï‡¶æ‡¶≤‡ßÄ‡¶® ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶´‡ßã‡¶ï‡¶æ‡¶∏‡ßá ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶® ‚Ä¢ ‡¶∂‡ßá‡¶∑ ‡¶π‡¶§‡ßá ‡¶¨‡¶æ‡¶ï‡¶ø: <b id="left">20</b>s</div>
      </div>
    </div>
  </div>

  <!-- Bottom dock -->
  <div class="dock">
    <div class="nav">
      <a class="tab active" data-tab="home">
        <svg viewBox="0 0 24 24"><path d="M3 10.5 12 3l9 7.5v9a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1v-9z"/></svg>
        <span class="tablabel">Home</span>
      </a>
      <a class="tab" data-tab="liked">
        <svg viewBox="0 0 24 24"><path d="M12.1 21.35 10 19.28C5.4 15.36 2 12.28 2 8.5 2 6 4 4 6.5 4c1.74 0 3.41.81 4.5 2.09C12.59 4.81 14.26 4 16 4 18.5 4 20.5 6 20.5 8.5c0 3.78-3.4 6.86-8 10.78l-2.4 2.07z"/></svg>
        <span class="tablabel">Liked</span>
      </a>
      <a class="tab" data-tab="tutorial">
        <svg viewBox="0 0 24 24"><path d="M4 5h12a3 3 0 0 1 3 3v11H7a3 3 0 0 1-3-3V5z"/><path d="M7 5v11a3 3 0 0 0 3 3h9"/></svg>
        <span class="tablabel">Tutorial</span>
      </a>
      <a class="tab" data-tab="links">
        <svg viewBox="0 0 24 24"><path d="M10 13a5 5 0 0 0 7 0l3-3a5 5 0 0 0-7-7l-1.5 1.5"/><path d="M14 11a5 5 0 0 0-7 0l-3 3a5 5 0 0 0 7 7L12.5 20"/></svg>
        <span class="tablabel">Links</span>
      </a>
    </div>
  </div>

<script>
  // ===== CONFIG =====
  const WID = "feE5b0a3-a507-4b7e-b855-d09f29f46e71";
  const JOIN_URL = "https://t.me/+JQdsBNK6nE1kNTg1";
  const REQUIRED = 10;

  // Posts with names & keywords
  let POSTS = [
    { id:"p1",
      title:"Jannat Toha Vairal Video ü•µ",
      names:["Jannat Toha","‡¶ú‡¶æ‡¶®‡ßç‡¶®‡¶æ‡¶§ ‡¶§‡ßã‡¶π‡¶æ"],
      desc:"‡¶ú‡¶æ‡¶®‡ßç‡¶®‡¶æ‡¶§ ‡¶§‡ßã‡¶π‡¶æ‡¶∞ ‡¶≠‡¶æ‡¶á‡¶∞‡¶æ‡¶≤ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶≤‡¶ø‡¶Ç‡¶ï üòç",
      img:"https://raw.githubusercontent.com/parvezparttoy/miniapp/main/IMG_20251018_193741_659.jpg",
      join:JOIN_URL,
      keywords:"jannat toha toha video viral tiktok ‡¶ú‡¶æ‡¶®‡ßç‡¶®‡¶æ‡¶§ ‡¶§‡ßã‡¶π‡¶æ"
    },
    { id:"p2",
      title:"Ridhii TikTok üíó",
      names:["Ridhii Moni","‡¶∞‡¶ø‡¶ß‡ßÄ ‡¶Æ‡¶®‡¶ø"],
      desc:"‡¶∞‡¶ø‡¶ß‡ßÄ ‡¶Æ‡¶®‡¶ø ‡¶≠‡¶æ‡¶á‡¶∞‡¶æ‡¶≤ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶≤‡¶ø‡¶Ç‡¶ï ü•µ",
      img:"https://raw.githubusercontent.com/parvezparttoy/miniapp/main/IMG_20251018_194758_066.jpg",
      join:JOIN_URL,
      keywords:"ridhii ridhi moni video viral tiktok ‡¶∞‡¶ø‡¶ß‡ßÄ"
    },
    { id:"p3",
      title:"Era Moni TikTok üíó",
      names:["Era Moni","‡¶á‡¶∞‡¶æ ‡¶Æ‡¶®‡¶ø"],
      desc:"‡¶á‡¶∞‡¶æ ‡¶Æ‡¶®‡¶ø ‡¶≠‡¶æ‡¶á‡¶∞‡¶æ‡¶≤ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶≤‡¶ø‡¶Ç‡¶ï üòçüí¶",
      img:"https://raw.githubusercontent.com/parvezparttoy/miniapp/main/IMG_20251016_155725_290.jpg",
      join:JOIN_URL,
      keywords:"era moni ira video viral tiktok ‡¶á‡¶∞‡¶æ ‡¶Æ‡¶®‡¶ø"
    }
  ];

  // Helpers
  const qs  = (s,p=document)=>p.querySelector(s);
  const qsa = (s,p=document)=>[...p.querySelectorAll(s)];
  const storeKey = (id)=>`coins_${id}`;
  const likeKey  = (id)=>`liked_${id}`;
  const doneKey  = (id)=>`done_${id}`;
  const pct = (v)=>Math.min(100, Math.round((v/REQUIRED)*100));

  // Telegram link opener + normal buttons in Links view
  function hookLinks(){
    document.querySelectorAll('[data-tglink], .openbtn').forEach(el=>{
      el.onclick = (e)=>{
        const href = el.getAttribute('href') || el.getAttribute('data-go');
        if(!href) return;
        if(href.startsWith('http') && window.Telegram?.WebApp?.openTelegramLink){
          e.preventDefault(); Telegram.WebApp.openTelegramLink(href);
        }
      };
    });
  }
  hookLinks();

  // Build search index
  const searchIndex = (p)=> (p.title + " " + p.desc + " " + (p.keywords||"") + " " + (p.names||[]).join(" ")).toLowerCase();

  // Render one card
  function renderCard(post){
    const coins = Number(localStorage.getItem(storeKey(post.id))||"0");
    const liked = localStorage.getItem(likeKey(post.id)) === "1";

    const card = document.createElement('div');
    card.className = 'card';
    card.setAttribute('data-id', post.id);
    card.innerHTML = `
      <button class="like ${liked?'active':''}" data-like="${post.id}" aria-label="like">
        <svg viewBox="0 0 24 24"><path d="M12.1 21.35 10 19.28C5.4 15.36 2 12.28 2 8.5 2 6 4 4 6.5 4 8.24 4 9.91 4.81 11 6.09 12.59 4.81 14.26 4 16 4 18.5 4 20.5 6 20.5 8.5c0 3.78-3.4 6.86-8 10.78l-2.4 2.07z"/></svg>
      </button>
      <img class="thumb" src="${post.img}" alt="">
      <div class="title">${post.title}</div>
      <div class="names">${(post.names||[]).join(' / ')}</div>
      <p class="desc">${post.desc}</p>
      <div class="progress"><div class="bar" id="${post.id}_bar" style="width:${pct(coins)}%"></div></div>
      <div class="row">
        <button class="btn watch ${coins>=REQUIRED?'disabled':''}" id="${post.id}_watch" ${coins>=REQUIRED?'disabled':''}>
          Watch Ads (${Math.min(coins,REQUIRED)}/${REQUIRED})
        </button>
        <button class="btn join ${coins>=REQUIRED?'ready':''}" id="${post.id}_join" ${coins>=REQUIRED?'':'disabled'}>
          Join Channel
        </button>
      </div>
    `;
    card.querySelector(`#${post.id}_watch`).onclick = ()=> openAd(post.id);
    card.querySelector(`#${post.id}_join`).onclick = ()=>{
      const c = Number(localStorage.getItem(storeKey(post.id))||"0");
      if(c>=REQUIRED){
        const url = post.join || "${JOIN_URL}";
        if(window.Telegram?.WebApp?.openTelegramLink) Telegram.WebApp.openTelegramLink(url);
        else window.open(url,'_blank');
      }
    };
    card.querySelector('[data-like]').onclick = ()=>{
      const btn = card.querySelector('.like');
      const active = btn.classList.toggle('active');
      localStorage.setItem(likeKey(post.id), active?'1':'0');
      refreshLiked();
    };
    return card;
  }

  // Render Home (filter + completed at bottom)
  function renderHome(filterText=''){
    const box = qs('#view-home'); box.innerHTML = '';
    const tokens = (filterText||'').trim().toLowerCase().split(/\s+/).filter(Boolean);

    const notDone = [], done = [];
    POSTS.forEach(p=>(localStorage.getItem(doneKey(p.id))==='1'?done:notDone).push(p));
    const list = [...notDone, ...done];

    const matches = (p)=> tokens.length ? tokens.some(t => searchIndex(p).includes(t)) : true;

    list.filter(matches).forEach(p=> box.appendChild(renderCard(p)));
    hookLinks();
  }

  function refreshLiked(){
    const likedBox = qs('#liked-container');
    likedBox.innerHTML = '';
    const likedPosts = POSTS.filter(p=>localStorage.getItem(likeKey(p.id))==='1');
    if(!likedPosts.length){
      likedBox.innerHTML = '<div class="card"><div class="desc">‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡¶ø‡¶õ‡ßÅ ‚ù§Ô∏è ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡¶®‡¶ø‡•§ Home ‡¶•‡ßá‡¶ï‡ßá ‡¶π‡¶æ‡¶∞‡ßç‡¶ü ‡¶ö‡¶æ‡¶™‡ßÅ‡¶®‡•§</div></div>';
      return;
    }
    likedPosts.forEach(p=>likedBox.appendChild(renderCard(p)));
    hookLinks();
  }

  // Search typing (Home only)
  qs('#searchInput').addEventListener('input', (e)=> renderHome(e.target.value));

  // Bottom nav switch + show/hide search & notes
  qsa('.tab').forEach(t=>{
    t.onclick = ()=>{
      qsa('.tab').forEach(x=>x.classList.remove('active'));
      t.classList.add('active');
      const name = t.getAttribute('data-tab');
      qsa('.view').forEach(v=>v.classList.remove('active'));
      qs('#view-'+name).classList.add('active');

      const showHome = (name==='home');
      qs('#searchWrap').classList.toggle('hide', !showHome);
      qs('#home-notes').classList.toggle('hide', !showHome);

      if(name==='liked')  refreshLiked();
      if(name==='home')   renderHome(qs('#searchInput').value);
    };
  });

  // ===== Interstitial with auto-reward =====
  const modal = qs('#adModal');
  const closeModal = qs('#closeModal');
  const leftEl   = qs('#left');
  let timer=null,left=20,focused=true,activeCard=null,rewarded=false;

  function openAd(cardId){
    activeCard = cardId;
    left = 20; rewarded=false; focused=true;
    leftEl.textContent = left;
    modal.style.display = "flex";

    try{
      if(window.AdexiumWidget){
        const ax = new AdexiumWidget({ wid: WID, adFormat: "interstitial" });
        ax.autoMode();
      }
    }catch(e){ console.log("Adexium error", e); }

    const onF=()=>focused=true, onB=()=>focused=false;
    window.addEventListener('focus',onF); window.addEventListener('blur',onB);

    timer = setInterval(()=>{
      if(focused && left>0){
        left--; leftEl.textContent = left;
        if(left<=0 && !rewarded){
          rewarded = true;
          addCoin(cardId); cleanup();
        }
      }
    },1000);

    function cleanup(){
      clearInterval(timer); timer=null;
      window.removeEventListener('focus',onF);
      window.removeEventListener('blur',onB);
      modal.style.display = 'none';
    }
    closeModal.onclick = cleanup; // ‡¶Ü‡¶ó‡ßá‡¶á ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶≤‡ßá ‡¶∞‡¶ø‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶π‡¶¨‡ßá ‡¶®‡¶æ
  }

  function addCoin(cardId){
    const key = storeKey(cardId);
    const cur = Number(localStorage.getItem(key)||"0");
    const next = Math.min(REQUIRED, cur+1);
    localStorage.setItem(key, next);

    // Update visible
    const bar = qs(`#${cardId}_bar`); if(bar) bar.style.width = pct(next)+'%';
    const w = qs(`#${cardId}_watch`); const j = qs(`#${cardId}_join`);
    if(w){ w.textContent = `Watch Ads (${next}/${REQUIRED})`; if(next>=REQUIRED){ w.classList.add('disabled'); w.disabled=true; } }
    if(j && next>=REQUIRED){ j.classList.add('ready'); j.disabled=false; }

    // completed => mark & push to very bottom
    if(next>=REQUIRED){
      localStorage.setItem(doneKey(cardId),'1');
      renderHome(qs('#searchInput').value);
    }
  }

  // initial render
  renderHome();
</script>
</body>
  </html>
